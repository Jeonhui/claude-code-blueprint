---
review_id: REVIEW-2026-02-20-001
date: 2026-02-20
agents: [audit-command-reviewer]
scope: "blueprint/**/commands/*.md, blueprint-*/**/commands/*.md"
total_issues: 19
---

# Review: REVIEW-2026-02-20-001

| ID | Priority | Status | Reviewer | Target | Title |
|:---|:---|:---|:---|:---|:---|
| AUDIT-2026-0001 | high | FIXED | audit-command-reviewer | blueprint/commands/agent-scaffold.md:58 | Underspecified TypeScript file templates |
| AUDIT-2026-0002 | high | FIXED | audit-command-reviewer | blueprint-mcp/commands/generate.md:60 | Existence check after dry-run exit |
| AUDIT-2026-0003 | high | FIXED | audit-command-reviewer | blueprint-audit/commands/fix.md:38 | Vague cross-references to default agent definitions |
| AUDIT-2026-0004 | medium | FIXED | audit-command-reviewer | blueprint/commands/init.md:14 | Glob tool misused for directory existence check |
| AUDIT-2026-0005 | medium | FIXED | audit-command-reviewer | blueprint/commands/init.md:24 | .mcp.json checked but never used |
| AUDIT-2026-0006 | medium | FIXED | audit-command-reviewer | blueprint/commands/status.md:6 | Missing English output directive in multiple commands |
| AUDIT-2026-0007 | medium | FIXED | audit-command-reviewer | blueprint/commands/agent-add.md:175 | Hardcoded agent validation list could drift |
| AUDIT-2026-0008 | medium | FIXED | audit-command-reviewer | blueprint/commands/hook-add.md:9 | No validation behavior for unknown event names |
| AUDIT-2026-0009 | medium | FIXED | audit-command-reviewer | blueprint/commands/tool-generate.md:37 | Underspecified index.js template |
| AUDIT-2026-0010 | medium | FIXED | audit-command-reviewer | blueprint/commands/skill-add.md:133 | No error behavior for invalid skill name |
| AUDIT-2026-0011 | medium | FIXED | audit-command-reviewer | blueprint/commands/export.md:11 | Missing default value for target parameter |
| AUDIT-2026-0012 | medium | FIXED | audit-command-reviewer | blueprint-mcp/commands/analyze.md:11 | Generic description for Node.js-specific command |
| AUDIT-2026-0013 | medium | FIXED | audit-command-reviewer | blueprint/commands/tool-link.md:5 | Unclear .mcp.json initial structure |
| AUDIT-2026-0014 | medium | FIXED | audit-command-reviewer | blueprint-audit/commands/review.md:267 | No type validation for optimizer with review |
| AUDIT-2026-0015 | medium | FIXED | audit-command-reviewer | blueprint-audit/commands/fix.md:76 | Inconsistent agent resolution error behavior |
| AUDIT-2026-0016 | medium | FIXED | audit-command-reviewer | blueprint-audit/commands/agent-add.md:44 | Auto-prefix edge case unhandled |
| AUDIT-2026-0017 | low | FIXED | audit-command-reviewer | blueprint/commands/agent-create.md:9 | Default maxTurns not documented |
| AUDIT-2026-0018 | low | FIXED | audit-command-reviewer | blueprint/commands/hook-list.md:10 | No error handling for malformed JSON |
| AUDIT-2026-0019 | low | FIXED | audit-command-reviewer | blueprint-mcp/commands/generate.md:74 | Hardcoded dependency versions |

---

## AUDIT-2026-0001: Underspecified TypeScript file templates in agent-scaffold
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** high
- **target:** blueprint/commands/agent-scaffold.md:58
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-20

### Description
Lines 58-59 describe creating `src/index.ts` as "Basic Agent SDK template with agentic loop and example tool definition" and `src/tools.ts` as "Example tool definitions" but provide no actual file content. In contrast, `package.json` and `tsconfig.json` have fully specified templates. This leaves the executor to invent content, producing inconsistent results across invocations that may not even be valid Anthropic Agent SDK code.

### Improvement Suggestion
Provide complete file templates for `src/index.ts` and `src/tools.ts` with working Anthropic Agent SDK code, similar to how `package.json` and `tsconfig.json` are fully specified. At minimum, provide a skeleton that imports `@anthropic-ai/sdk`, creates a client, and runs an agentic loop.

---

## AUDIT-2026-0002: Existence check runs after dry-run exit, causing contradictory flow
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** high
- **target:** blueprint-mcp/commands/generate.md:60
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Step 4 (line 44) handles `--dry-run` and says "output a preview and stop". Step 5 (line 60) checks if the server already exists. This ordering means in dry-run mode, the user would see a successful preview even if the server already exists, since the existence check never runs. Actual generation would then fail at step 5.

### Improvement Suggestion
Move step 5 (existence check) to before step 4 (dry-run output), so that both dry-run and actual execution correctly report if the server already exists. Reorder to: current step 3 -> current step 5 (existence check) -> current step 4 (dry-run) -> current step 6.

---

## AUDIT-2026-0003: Vague cross-references to default agent definitions
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** high
- **target:** blueprint-audit/commands/fix.md:38
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Three files (fix.md:38, agent-add.md:35, status.md:34) reference default agent definitions with "as defined in the review command" without specifying the exact section or file path. If review.md is renamed or restructured, these references silently break.

### Improvement Suggestion
Change all three references to: "as defined in the 'Default Agent Definitions' section of `/blueprint-audit:review` (`blueprint-audit/commands/review.md`)." This anchors the reference to both the command path and the specific section heading.

---

## AUDIT-2026-0004: Glob tool misused for directory existence check
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint/commands/init.md:14
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Step 1 says "Check which of these paths already exist using Glob and Read" but Glob matches file patterns and Read reads file contents. Neither is the correct tool to verify whether a bare directory exists (e.g., `.claude/rules/`). A directory without files will not appear in Glob results.

### Improvement Suggestion
Change to: "Check which of these paths already exist using Bash (`test -d`, `test -f`) and Read."

---

## AUDIT-2026-0005: .mcp.json listed in check but never created or acted upon
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint/commands/init.md:24
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Step 1 includes `.mcp.json` in the list of paths to check, but Steps 2-4 never create it, reference it, or report anything about it. The check result is unused, which is confusing for an executor.

### Improvement Suggestion
Either remove `.mcp.json` from the Step 1 check list, or add it to Step 4 as an informational line in the report (e.g., "`.mcp.json`: present / not found").

---

## AUDIT-2026-0006: Missing English output directive in multiple output-generating commands
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint/commands/status.md:6
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Several commands that generate output lack the "IMPORTANT: All generated file content and output must be written in English." directive, while other similar commands include it. Affected files: status.md, agent-list.md, command-list.md, agent-scaffold.md, hook-add.md, skill-add.md, tool-link.md, hook-list.md, skill-list.md. This inconsistency could lead to non-English output for non-English-speaking users.

### Improvement Suggestion
Add the English output directive to all commands that produce output or write file content, matching the pattern in commands like init.md, doctor.md, and agent-create.md.

---

## AUDIT-2026-0007: Hardcoded agent validation list could drift from definitions
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint/commands/agent-add.md:175
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Step 2 (line 175) hardcodes valid agent names as a validation list: "only `code-reviewer`, `debugger`, `test-engineer`, `architect`, `security-reviewer` are valid". This duplicates the information already expressed by the `### <name>` headings in the "Available Agents" section. If a new agent is added to the templates section but the validation list is not updated, the command would reject a valid agent.

### Improvement Suggestion
Rewrite Step 2 to say "Validate: the agent name must match one of the `### <name>` headings in the Available Agents section above" instead of repeating the list. This makes validation self-referential and avoids drift.

---

## AUDIT-2026-0008: No validation behavior for unknown event names
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint/commands/hook-add.md:9
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
The event list on line 9 includes known events but does not indicate whether this is exhaustive. There is no guidance on what to do if the user provides an event name not in this list (validate and reject, or accept with a warning).

### Improvement Suggestion
Add a validation instruction: "If event is not one of the known events, warn the user but proceed anyway" or "reject with an error listing valid events." This makes the error-handling behavior explicit.

---

## AUDIT-2026-0009: Underspecified index.js template
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint/commands/tool-generate.md:37
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Line 37 says "index.js: MCP server template with stdio transport, one example tool with zod schema." This is a vague one-line description compared to the fully specified `package.json` template. The implementer has no concrete specification for what the generated index.js should contain -- no function names, no tool schema structure, no import patterns.

### Improvement Suggestion
Provide a concrete template for index.js similar to the package.json template, specifying: the import structure, the server initialization pattern, the example tool name/schema, and the stdio transport setup code.

---

## AUDIT-2026-0010: No explicit error behavior for invalid skill name
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint/commands/skill-add.md:133
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Step 2 (line 133) says to validate that only the four built-in skills are valid, but does not specify the error message or behavior when validation fails. Other commands like tool-generate.md say "report and stop", but skill-add only says "validate".

### Improvement Suggestion
Change to: "Validate: only `rest-api-guide`, `test-convention`, `typescript-strict`, `git-workflow` are valid. If invalid, report error listing available skills and stop."

---

## AUDIT-2026-0011: Missing default value for target parameter
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint/commands/export.md:11
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Lines 11-14 list four target options (codex, gemini, copilot, all), but there is no default specified. If the user invokes `/blueprint:export` with no arguments, the command behavior is undefined.

### Improvement Suggestion
Either specify a default (e.g., "default: all") or add an instruction to report an error if no target is specified: "If no target specified, report error listing available targets."

---

## AUDIT-2026-0012: Generic description for Node.js-specific command
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint-mcp/commands/analyze.md:11
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
The command description says "Analyze project tech stack" generically, but the entire analysis hinges on `package.json` existing. Projects using other ecosystems (Python, Go, Rust) would get an unhelpful error.

### Improvement Suggestion
Clarify the description to specify this is for Node.js/JavaScript/TypeScript projects, e.g., "Analyze the current **Node.js** project's tech stack (frameworks, databases, API patterns, directory structure) to prepare for custom MCP server generation."

---

## AUDIT-2026-0013: Unclear .mcp.json initial creation structure
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint/commands/tool-link.md:5
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
The step says "create with `{}` if doesn't exist" followed by "Ensure `mcpServers` key exists" as a separate step. The created file should actually be `{ "mcpServers": {} }` or the two steps should be more explicitly linked.

### Improvement Suggestion
Combine for clarity: "Read `.mcp.json` (create with `{ "mcpServers": {} }` if doesn't exist)" or keep separate but make the second step explicit: "If `mcpServers` key does not exist, add it as an empty object."

---

## AUDIT-2026-0014: No type validation when using optimizer agent with review command
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint-audit/commands/review.md:267
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Using `--by audit-fixer` with the review command would attempt to run a review with an optimizer agent that has no Review Checklist section. There is no validation step that checks the resolved agent's type and warns when it is not `auditor`.

### Improvement Suggestion
Add a validation step in the "Review Execution" section that checks the resolved agent's `type` field and warns: "Warning: Agent `<name>` has type `optimizer`, not `auditor`. Review behavior may be undefined."

---

## AUDIT-2026-0015: Inconsistent agent name resolution error behavior between fix and review
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint-audit/commands/fix.md:76
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
The fix command (line 76) says to "list optimizer-type agents" on error, while the review command (review.md line 110) says to "list files in `.claude/agents/`" (all agents, unfiltered). This means the fix command helpfully filters to relevant agents, but the review command shows all agents including optimizers that cannot be used for review.

### Improvement Suggestion
Update review.md line 110 to be consistent: "report error... then list auditor-type agents in `.claude/agents/`." This makes both commands filter their agent lists to only show relevant agent types.

---

## AUDIT-2026-0016: Auto-prefix edge case for "--name audit" not handled
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** medium
- **target:** blueprint-audit/commands/agent-add.md:44
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
If a user passes `--name audit`, the auto-prefix logic would produce `audit-audit` since the name itself is `audit` which does not start with `audit-` (it lacks the hyphen). This is likely unintended. The edge case is not addressed.

### Improvement Suggestion
Add explicit handling: "If `--name audit` is provided (just the prefix word), treat it as invalid and report: 'Please provide a descriptive name after `audit-`, e.g., `--name security`'."

---

## AUDIT-2026-0017: Default maxTurns not documented
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** low
- **target:** blueprint/commands/agent-create.md:9
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
The parameters list documents defaults for `model` (sonnet) but does not specify a default for `max_turns`. The template includes `maxTurns: <max_turns>`, so if the user omits `--max-turns`, the executor has no guidance on what value to use.

### Improvement Suggestion
Add a default value for max_turns, e.g., "max_turns (optional, default: 10): Maximum agentic turns." Alternatively, document that maxTurns should be omitted from frontmatter when not provided.

---

## AUDIT-2026-0018: No error handling for malformed JSON in settings.json
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** low
- **target:** blueprint/commands/hook-list.md:10
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Step 1 instructs to read `.claude/settings.json` and step 2 handles missing file or missing `hooks` key. However, there is no instruction for what to do if the file exists but contains invalid/malformed JSON.

### Improvement Suggestion
Add a step: "If the file exists but contains invalid JSON, report an error: 'settings.json contains invalid JSON. Please fix it manually or re-create it.'"

---

## AUDIT-2026-0019: Hardcoded dependency versions will become stale
- **status:** FIXED
- **reviewer:** audit-command-reviewer
- **priority:** low
- **target:** blueprint-mcp/commands/generate.md:74
- **fixed_by:** audit-fixer
- **fixed_date:** 2026-02-21

### Description
Lines 74-75 hardcode `"@modelcontextprotocol/sdk": "^1.12.1"` and `"zod": "^3.24.2"`. These versions will become outdated over time and there is no instruction to check for latest versions.

### Improvement Suggestion
Add an instruction note indicating these are baseline versions and suggesting implementers check for latest compatible versions, or add a step that runs `npm view @modelcontextprotocol/sdk version` to get the latest.
